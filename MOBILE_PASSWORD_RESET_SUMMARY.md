# æ ¹æ®æ‰‹æœºå·é‡ç½®å¯†ç æ¥å£å®ç°æ€»ç»“

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æ–°å¢äº†ä¸€ä¸ªæ ¹æ®æ‰‹æœºå·å’ŒçŸ­ä¿¡éªŒè¯ç é‡ç½®ç”¨æˆ·å¯†ç çš„æ¥å£ï¼Œç”¨äºå¿˜è®°å¯†ç æ—¶çš„å¯†ç é‡ç½®åŠŸèƒ½ã€‚

## ğŸ”§ å®ç°å†…å®¹

### 1. æ–°å¢æ¥å£å‡½æ•°

**æ–‡ä»¶**: `routes/user/update.py`

**å‡½æ•°**: `update_password_by_mobile()`

**åŠŸèƒ½**:
- éªŒè¯æ‰‹æœºå·æ ¼å¼ï¼ˆ11ä½æ•°å­—ï¼‰
- éªŒè¯æ–°å¯†ç é•¿åº¦ï¼ˆè‡³å°‘6ä¸ªå­—ç¬¦ï¼‰
- æŸ¥æ‰¾ç”¨æˆ·å¹¶æ›´æ–°å¯†ç 
- è¿”å›æ“ä½œç»“æœ
- æ³¨æ„ï¼šçŸ­ä¿¡éªŒè¯ç éªŒè¯ç”±å®¢æˆ·ç«¯å¤„ç†

### 2. è·¯ç”±æ³¨å†Œ

**æ–‡ä»¶**: `routes/user/__init__.py`

**è·¯ç”±**: `POST /users/reset-password`

**æ˜ å°„**: `user_bp.route('/reset-password', methods=['POST'])(update_password_by_mobile)`

## ğŸ“¡ APIæ¥å£è¯¦æƒ…

### è¯·æ±‚ä¿¡æ¯

- **æ–¹æ³•**: POST
- **è·¯å¾„**: `/users/reset-password`
- **Content-Type**: application/json

### è¯·æ±‚å‚æ•°

```json
{
    "mobile": "13800138000",      // å¿…å¡«ï¼Œç”¨æˆ·æ‰‹æœºå·ï¼Œ11ä½æ•°å­—
    "new_password": "newpass123"  // å¿…å¡«ï¼Œæ–°å¯†ç ï¼Œè‡³å°‘6ä¸ªå­—ç¬¦
}
```

### å“åº”æ ¼å¼

#### æˆåŠŸå“åº” (200)

```json
{
    "success": true,
    "message": "å¯†ç æ›´æ–°æˆåŠŸ",
    "data": {
        "id": "ç”¨æˆ·ID",
        "username": "ç”¨æˆ·å",
        "mobile": "æ‰‹æœºå·",
        "updatedAt": "æ›´æ–°æ—¶é—´"
    }
}
```

#### å¤±è´¥å“åº”

```json
{
    "success": false,
    "error": "é”™è¯¯ä¿¡æ¯"
}
```

### é”™è¯¯ç è¯´æ˜

- **400**: å‚æ•°é”™è¯¯
  - ç¼ºå°‘å¿…éœ€å‚æ•°
  - æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®
  - å¯†ç é•¿åº¦ä¸è¶³
- **404**: æ‰‹æœºå·æœªæ³¨å†Œ
- **500**: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **å®¢æˆ·ç«¯éªŒè¯**: çŸ­ä¿¡éªŒè¯ç éªŒè¯ç”±å®¢æˆ·ç«¯å¤„ç†ï¼ŒæœåŠ¡ç«¯ä¿¡ä»»å®¢æˆ·ç«¯éªŒè¯ç»“æœ
2. **å¯†ç åŠ å¯†**: ä½¿ç”¨Werkzeugçš„å¯†ç å“ˆå¸ŒåŠŸèƒ½åŠ å¯†æ–°å¯†ç 
3. **å‚æ•°éªŒè¯**: ä¸¥æ ¼éªŒè¯æ‰€æœ‰è¾“å…¥å‚æ•°
4. **ç”¨æˆ·å­˜åœ¨æ€§æ£€æŸ¥**: ç¡®ä¿æ‰‹æœºå·å¯¹åº”çš„ç”¨æˆ·å­˜åœ¨

## ğŸš€ ä½¿ç”¨æµç¨‹

1. ç”¨æˆ·è¾“å…¥æ‰‹æœºå·
2. å®¢æˆ·ç«¯è°ƒç”¨çŸ­ä¿¡å‘é€æ¥å£å‘é€éªŒè¯ç 
3. ç”¨æˆ·è¾“å…¥æ”¶åˆ°çš„éªŒè¯ç ï¼Œå®¢æˆ·ç«¯éªŒè¯
4. éªŒè¯é€šè¿‡åï¼Œç”¨æˆ·è¾“å…¥æ–°å¯†ç 
5. è°ƒç”¨æ­¤æ¥å£é‡ç½®å¯†ç 
6. æ ¹æ®å“åº”ç»“æœæç¤ºç”¨æˆ·

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### Pythonç¤ºä¾‹

```python
import requests

url = "http://localhost:8000/users/reset-password"
data = {
    "mobile": "13800138000",
    "new_password": "newpass123"
}

response = requests.post(url, json=data)
result = response.json()

if result['success']:
    print("å¯†ç é‡ç½®æˆåŠŸ!")
else:
    print(f"é‡ç½®å¤±è´¥: {result['error']}")
```

### cURLç¤ºä¾‹

```bash
curl -X POST "http://localhost:8000/users/reset-password" \
  -H "Content-Type: application/json" \
  -d '{
    "mobile": "13800138000",
    "new_password": "newpass123"
  }'
```

### JavaScriptç¤ºä¾‹

```javascript
async function resetPasswordByMobile(mobile, newPassword) {
    const response = await fetch('/users/reset-password', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            mobile: mobile,
            new_password: newPassword
        })
    });
    
    const result = await response.json();
    return result;
}
```

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `routes/user/update.py` - ä¸»è¦å®ç°æ–‡ä»¶
- `routes/user/__init__.py` - è·¯ç”±æ³¨å†Œ
- `examples/mobile_password_reset_example.py` - ä½¿ç”¨ç¤ºä¾‹
- `models/user.py` - ç”¨æˆ·æ¨¡å‹ï¼ˆå·²å­˜åœ¨ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å®¢æˆ·ç«¯éªŒè¯**: çŸ­ä¿¡éªŒè¯ç éªŒè¯ç”±å®¢æˆ·ç«¯å¤„ç†ï¼ŒæœåŠ¡ç«¯ä¸è¿›è¡ŒéªŒè¯
2. **çŸ­ä¿¡æœåŠ¡**: å®¢æˆ·ç«¯éœ€è¦å…ˆè°ƒç”¨çŸ­ä¿¡å‘é€å’ŒéªŒè¯æ¥å£
3. **æœåŠ¡å™¨è¿è¡Œ**: æµ‹è¯•å‰ç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
4. **æ•°æ®åº“è¿æ¥**: ç¡®ä¿æ•°æ®åº“è¿æ¥æ­£å¸¸

## ğŸ”„ ä¸ç°æœ‰æ¥å£çš„åŒºåˆ«

| æ¥å£ | è·¯å¾„ | ç”¨é€” | éªŒè¯æ–¹å¼ |
|------|------|------|----------|
| æ ¹æ®IDæ›´æ–°å¯†ç  | `PUT /users/{id}/password` | å·²çŸ¥æ—§å¯†ç æ—¶ä¿®æ”¹ | æ—§å¯†ç éªŒè¯ |
| æ ¹æ®æ‰‹æœºå·é‡ç½®å¯†ç  | `POST /users/reset-password` | å¿˜è®°å¯†ç æ—¶é‡ç½® | å®¢æˆ·ç«¯éªŒè¯çŸ­ä¿¡éªŒè¯ç  |

## âœ… æµ‹è¯•å»ºè®®

1. æµ‹è¯•å„ç§å‚æ•°éªŒè¯åœºæ™¯
2. æµ‹è¯•ä¸å­˜åœ¨çš„æ‰‹æœºå·
3. æµ‹è¯•å¯†ç é•¿åº¦é™åˆ¶
4. ç¡®ä¿å®¢æˆ·ç«¯æ­£ç¡®å¤„ç†çŸ­ä¿¡éªŒè¯ç éªŒè¯æµç¨‹

## ğŸ¯ å®ŒæˆçŠ¶æ€

- âœ… æ¥å£å‡½æ•°å®ç°
- âœ… è·¯ç”±æ³¨å†Œ
- âœ… å‚æ•°éªŒè¯
- âœ… é”™è¯¯å¤„ç†
- âœ… ä½¿ç”¨ç¤ºä¾‹
- âœ… æ–‡æ¡£ç¼–å†™

æ¥å£å·²å®Œå…¨å®ç°å¹¶å¯ä»¥ä½¿ç”¨ï¼
